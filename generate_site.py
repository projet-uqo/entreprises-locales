# -*- coding: utf-8 -*-
"""generer_site_web_entreprises_locales.ipynb

Automatically generated by Colab.

"""

# üìö Importer les modules
import pandas as pd
import numpy as np
from geopy.geocoders import Nominatim
from geopy.exc import GeocoderTimedOut, GeocoderUnavailable
from time import sleep
from tqdm import tqdm
import folium
from folium.plugins import Fullscreen
import os

# Charger le fichier excel et lire la feuille principale (entreprises)

df = pd.read_excel("Informations sur les entreprises.xlsx")

# Affiche les premi√®res lignes pour v√©rifier
df

# Nettoyage de base
df["Adresse"] = (
    df["Adresse"].astype(str)
                 .str.strip()
                 .str.replace(r"\s+", " ", regex=True)
                 .str.replace("Gatineau(", "Gatineau, ", regex=False)
                 .str.replace(")", "", regex=False)
)

# Compl√©ter ville/province/pays si manquants
def ensure_city(address):
    a = address.strip()
    # Si l‚Äôadresse ne contient pas ‚Äúgatineau‚Äù ou ‚Äúqc‚Äù, on append un contexte
    if "gatineau" not in a.lower() and "qu√©bec" not in a.lower() and "qc" not in a.lower():
        a = f"{a}, Gatineau, QC, Canada"
    elif "canada" not in a.lower():
        a = f"{a}, Canada"
    return a

df["Adresse_geocode"] = df["Adresse"].apply(ensure_city)

# Enlever les adresses invalides
invalid_tokens = {"", "nan", "none", "pas trouv√©", "na"}
df_valides = (
    df[df["Adresse_geocode"].notnull()]
      .copy()
)
df_valides["Adresse_geocode_low"] = df_valides["Adresse_geocode"].str.lower().str.strip()
df_valides = df_valides[~df_valides["Adresse_geocode_low"].isin(invalid_tokens)].copy()

# Initialiser le g√©ocodeur
geolocator = Nominatim(user_agent="carte_pme_gatineau", timeout=10)

# Fonction de g√©ocodage avec pause et gestion d'erreurs
def geocode_adresse(adresse):
    try:
        sleep(1)  # Pause pour √©viter le blocage
        location = geolocator.geocode(adresse, exactly_one=True, addressdetails=False)
        if location:
            return location.latitude, location.longitude
    except (GeocoderTimedOut, GeocoderUnavailable):
        return None, None
    except Exception:
        return None, None
    return None, None

# üßπ Filtrer les adresses valides
df_valides = df[df["Adresse"].notnull() & ~df["Adresse"].str.lower().isin(["nan"])].copy()

# Supprimer les doublons (par exemple sur Nom + Adresse)
nb_avant = len(df_valides)
df_valides = df_valides.drop_duplicates(subset=["Nom de l'entreprise", "Adresse"])
nb_apres = len(df_valides)

if nb_avant > nb_apres:
    print(f"‚ö†Ô∏è {nb_avant - nb_apres} doublon(s) supprim√©(s) dans les adresses valides.")

# üìç G√©ocoder uniquement si Latitude/Longitude manquantes

# Cr√©er lat/long si absentes aussi dans la copie
for col in ["Latitude", "Longitude"]:
    if col not in df_valides.columns:
        df_valides[col] = pd.Series(dtype="float64")

mask = df_valides["Latitude"].isnull() | df_valides["Longitude"].isnull()

# Liste des adresses √† g√©ocoder
adresses = df_valides.loc[mask, "Adresse_geocode"]

# G√©ocodage avec barre de progression compatible Pandas 2.2+
coords = []
for adresse in tqdm(adresses, desc="G√©ocodage"):
    lat, lon = geocode_adresse(adresse)
    # Convertir None ‚Üí np.nan
    if lat is None:
        lat = np.nan
    if lon is None:
        lon = np.nan
    coords.append((lat, lon))

# Convertir en DataFrame pour √©viter les erreurs de dtype
coords_df = pd.DataFrame(coords, columns=["Latitude", "Longitude"])

# Injection propre
df_valides.loc[mask, ["Latitude", "Longitude"]] = coords_df.values

# Mettre √† jour les coordonn√©es dans df original
df.update(df_valides[["Latitude", "Longitude"]])

# Ajouter une colonne pour indiquer si le g√©ocodage a r√©ussi
df["geocode_ok"] = df["Latitude"].notnull() & df["Longitude"].notnull()

# Sauvegarde dans le fichier Excel (mise √† jour)
df.to_excel("Informations sur les entreprises.xlsx", index=False)

# Mettre √† jour les coordonn√©es dans le DataFrame principal
#for idx, row in df_valides.iterrows():
#    df.loc[idx, "Latitude"] = row["Latitude"]
#    df.loc[idx, "Longitude"] = row["Longitude"]

# Afficher les entreprises g√©ocod√©es avec succ√®s
df_valides_final = df[df["geocode_ok"]].copy()
print(df_valides_final[["Nom de l'entreprise", "Adresse","Site internet", "Secteur", "Latitude", "Longitude", "Logo"]])

"""G√©n√©rer carte"""

# Nettoyer les colonnes pour √©viter les NaN
df_valides_final["Site internet"] = df_valides_final["Site internet"].fillna('')
df_valides_final["Secteur"] = df_valides_final["Secteur"].fillna("Secteur non pr√©cis√©")

# Cr√©er la carte centr√©e sur Gatineau
carte = folium.Map(location=[45.4765, -75.7013], zoom_start=12)
Fullscreen(position='topright').add_to(carte)

# Dictionnaire secteur ‚Üí ic√¥ne  (√† modifier pour que cela corresponde aux cat√©gories des entreprises)

secteur_icons = {
    "Agroalimentaire": ("green", "utensils", "fa"),
    "Microbrasserie": ("darkgreen", "beer", "fa"),
    "Arts, spectacles et loisirs": ("purple", "palette", "fa"),
    "Architecture et am√©nagement": ("darkblue", "drafting-compass", "fa"),
    "Chauffage et Climatisation": ("gray", "thermometer-half", "fa"),
    "Apprentissage, g√©om√®tre": ("cadetblue", "ruler-combined", "fa"),
    "Divertissement et pension animale": ("orange", "paw", "fa"),
    "Agence de voyages": ("lightblue", "plane", "fa"),
    "Ameublement, fournitures et accessoires": ("brown", "couch", "fa"),
    "Vente et r√©paration d'article de plein air": ("olive", "campground", "fa"),
    "Commerce": ("orange", "shopping-cart", "fa"),
    "Services aux entreprises": ("blue", "briefcase", "fa"),
    "√âducation": ("cadetblue", "graduation-cap", "fa"),
    "Sant√©": ("red", "hospital", "fa"),
    "Construction / Architecture": ("darkblue", "hammer", "fa"),
    "Transport / Logistique": ("lightblue", "truck", "fa"),
    "Finance": ("darkred", "money-bill", "fa"),
    "Technologie / Innovation": ("black", "microchip", "fa"),
    "Nature / Environnement": ("darkgreen", "tree", "fa"),
    "Secteur non pr√©cis√©": ("gray", "question", "fa")
}

df_valides_final = df_valides_final.dropna(subset=["Latitude", "Longitude"])

# Boucle sur les entreprises valides
for _, row in df_valides_final.iterrows():
    nom = row["Nom de l'entreprise"]
    secteur = row["Secteur"]
    site = row["Site internet"]
    adresse = row["Adresse"]

    # Bouton cliquable si site valide
    if site and site.startswith("http"):
        bouton_site = f"<a href='{site}' target='_blank' style='display:inline-block; margin-top:6px; padding:6px 12px; background-color:#3498db; color:white; text-decoration:none; border-radius:4px;'>üåê Visiter le site</a>"
    else:
        bouton_site = "<i>Site web non disponible</i>"

    # Choisir ic√¥ne selon secteur
    color, icon, prefix = secteur_icons.get(secteur, ("gray", "info-sign", "glyphicon"))

    # HTML stylis√© pour le popup
    popup_html = f"""
    <div style='font-family:Arial; font-size:14px; line-height:1.5; max-width:250px;'>
        <h4 style='margin:0; color:#2c3e50;'>{nom}</h4>
        <p style='margin:4px 0;'><strong>Secteur :</strong> {secteur}</p>
        <p style='margin:4px 0;'><strong>Adresse :</strong> {adresse}</p>
        {bouton_site}
    </div>
    """

    popup = folium.Popup(popup_html, max_width=300)

    folium.Marker(
        location=[row["Latitude"], row["Longitude"]],
        popup=popup,
        tooltip=nom,
        icon=folium.Icon(color=color, icon=icon, prefix=prefix)
    ).add_to(carte)

# Sauvegarder la carte dans un fichier HTML
carte.save("carte_pme_gatineau.html")

"""G√©n√©rer la page HTML compl√®te avec navigation + carte

# Style commun des pages
"""

style_css = """
/* style.css */

/* Haut de page */
header {
  background-color: #2a5d84;
  color: white;
  padding: 20px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 20px;
  flex-wrap: wrap; /* ‚úÖ permet d'adapter sur mobile */
}

header img.logo {
  height: 60px;
  width: auto;
  border-radius: 6px;
}

/* Pour centrer l'en-t√™te et la barre de navigation visuellement */
header, nav {
  max-width: 1000px;
  margin: 20px auto;
  border-radius: 8px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

/* Barre de navigation */
nav {
  background-color: #e0e0e0;
  display: flex;
  justify-content: center;
  gap: 30px;
  padding: 12px 0;
  flex-wrap: wrap; /* ‚úÖ navigation adaptable */
}

nav a {
  text-decoration: none;
  color: #2a5d84;
  font-weight: bold;
  font-size: 16px;
}
nav a:hover {
  text-decoration: underline;
}

body {
  font-family: Arial, sans-serif;
  margin: 0;
  background-color: #f9f9f9;
}

.content {
  max-width: 900px;
  margin: 40px auto;
  padding: 0 20px;
}
h2 {
  color: #2a5d84;
}
p {
  font-size: 18px;
  line-height: 1.6;
  color: #333;
}

/* Pied de page bleu */
footer {
  background-color: #2a5d84;
  color: white;
  text-align: center;
  padding: 20px;
  margin-top: 40px;
}

/* Pour la carte */
iframe {
  width: 100%;
  border: none;
  border-radius: 8px;
  box-shadow: 0 0 10px rgba(0,0,0,0.05);
}

.secteurs {
  margin: 20px;
}

.secteurs section {
  margin-bottom: 40px;
}

/* ‚úÖ Galerie des entreprises */
.entreprises {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  justify-content: center; /* centrer sur mobile */
}

.card {
  background: #fff;
  border: 1px solid #ddd;
  border-radius: 8px;
  width: 220px;
  padding: 15px;
  text-align: center;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  transition: transform 0.2s;
}

.card:hover {
  transform: scale(1.05);
}

.card img {
  max-width: 100%;
  height: 120px;
  object-fit: contain;
  margin-bottom: 10px;
}

.card h4 {
  font-size: 1.1em;
  margin: 10px 0;
}

.card a {
  display: inline-block;
  margin-top: 5px;
  color: #007BFF;
  text-decoration: none;
}

.card a:hover {
  text-decoration: underline;
}

.card p {
  font-size: 0.9em;
  color: #555;
  margin: 8px 0;
}


/* ‚úÖ Bloc entreprise avec produits */
.entreprise {
  margin-bottom: 30px;
  padding: 15px;
  border: 1px solid #ddd;
  border-radius: 8px;
  background: #fdfdfd;
}

.entreprise h3 {
  color: #2a5d84;
}

.produits {
  list-style-type: disc;
  margin-left: 20px;
}

.produits li {
  margin: 5px 0;
}

/* ‚úÖ Responsive design */
@media (max-width: 768px) {
  nav {
    flex-direction: column;
    gap: 10px;
  }

  .card {
    width: 100%; /* ‚úÖ cartes prennent toute la largeur sur mobile */
  }

  .content {
    margin: 20px auto;
    padding: 0 10px;
  }

  p {
    font-size: 16px;
  }
}

/* ‚úÖ Banni√®re d'avertissement */
.banner {
  background-color: #f1c40f;   /* jaune vif */
  color: #2c3e50;              /* texte gris fonc√© pour contraste */
  text-align: center;          /* centrer le texte */
  font-weight: bold;
  font-size: 16px;
  padding: 12px;
  margin: 10px auto;
  max-width: 1000px;           /* align√© avec header/nav */
  border-radius: 6px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  display: flex;               /* permet d'ajouter un ic√¥ne */
  align-items: center;
  justify-content: center;
  gap: 10px;                   /* espace entre ic√¥ne et texte */
}

.banner .icon {
  font-size: 20px;             /* taille de l'ic√¥ne */
}

/* Grille des produits */
.produits-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: 16px;
  margin: 12px 0;
}

/* Carte produit */
.product-card {
  background: #fff;
  border: 1px solid #ddd;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
  transition: transform 0.2s, box-shadow 0.2s;
}
.product-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(0,0,0,0.12);
}

/* Image */
.product-image {
  background: #f7f7f7;
  display: flex;
  align-items: center;
  justify-content: center;
  height: 160px;
}
.product-image img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
}

/* Infos */
.product-info {
  padding: 12px;
}
.product-name {
  font-weight: 600;
  color: #2a2a2a;
  margin-bottom: 6px;
}
.product-price {
  color: #1a7f37; /* vert style ‚Äúprix‚Äù */
  font-weight: 600;
  margin-bottom: 8px;
}
.product-desc {
  color: #555;
  font-size: 0.92em;
  line-height: 1.4;
}

/* Bouton Voir plus / Voir moins */
.produits-actions {
  margin-top: 8px;
}
.btn-toggle {
  background: #2a5d84;
  color: #fff;
  border: none;
  padding: 8px 14px;
  border-radius: 6px;
  cursor: pointer;
}
.btn-toggle:hover {
  background: #1f4868;
}

/* Bouton Facebook uniquement ic√¥ne */
.btn-facebook-icon {
  display: inline-block;
  background-color: #1877f2; /* bleu Facebook */
  color: white;
  font-size: 20px; /* taille de l‚Äôic√¥ne */
  padding: 10px 14px;
  border-radius: 50%; /* cercle autour de l‚Äôic√¥ne */
  text-align: center;
  transition: background-color 0.2s ease, transform 0.2s ease;
}

.btn-facebook-icon:hover {
  background-color: #145dbf; /* bleu plus fonc√© au survol */
  transform: scale(1.1); /* petit effet zoom */
}

.btn-facebook-icon i {
  vertical-align: middle;
}
"""
with open("style.css", "w", encoding="utf-8") as f:
    f.write(style_css)

"""# En-t√™te html r√©utilisable"""

def bloc_entete(titre_page):
    # Dictionnaire des meta descriptions par page
    meta_descriptions = {
        "Accueil": "Bienvenue sur Entreprises locales √† Gatineau : d√©couvrez la carte interactive et les commerces locaux √† proximit√© de chez vous.",
        "Liste des entreprises": "Consultez la liste compl√®te des entreprises locales de Gatineau : coordonn√©es, secteurs d‚Äôactivit√© et liens vers leurs sites web.",
        "Produits offerts": "Explorez les produits et services propos√©s par les entreprises locales de Gatineau, class√©s par secteur d‚Äôactivit√©.",
        "Nous contacter": "Contactez notre √©quipe pour en savoir davantage sur notre projet et la valorisation des entreprises locales."
    }

    # Choisir la bonne description (par d√©faut une g√©n√©rique)
    description = meta_descriptions.get(titre_page, "D√©couvrez les entreprises locales de Gatineau gr√¢ce √† notre carte interactive et nos listes.")

    return f"""
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>{titre_page}</title>

  <!-- SEO -->
  <meta name="description" content="{description}">
  <meta name="keywords" content="Gatineau, entreprises locales, commerce, services, carte interactive, produits locaux">
  <meta name="author" content="D√©couvrez Gatineau: nos entreprises locales">

  <!-- Accessibilit√© et affichage -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Open Graph (r√©seaux sociaux) -->
  <meta property="og:title" content="{titre_page} | Entreprises locales √† Gatineau">
  <meta property="og:description" content="{description}">
  <meta property="og:image" content="logo.png">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://github.com/projet-uqo/entreprises-locales">

  <!-- Favicon -->
  <link rel="icon" href="logo.png" type="image/png">

  <!-- Feuille de style -->
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <img src="logo.png" alt="Logo du site" class="logo">
    <h1>Entreprises locales √† Gatineau</h1>
  </header>

  <!-- ‚úÖ Banni√®re d‚Äôavertissement -->
  <div class="banner">
    <span class="icon">‚ö†Ô∏è</span>
    Ce site est en d√©veloppement. Au plaisir de vous revoir!
  </div>


  <nav>
    <a href="index.html">Accueil</a>
    <a href="liste.html">Liste des entreprises</a>
    <a href="produits.html">Produits offerts</a>
    <a href="contact.html">Nous contacter</a>
  </nav>
  <div class="content">
"""

"""# Pied de page html"""

bloc_footer = """
  </div>
    <footer>
    <p>&copy; 2025 - D√©couvrez Gatineau: Nos entreprises locales</p>
  </footer>
</body>
</html>
"""

"""# Page d'accueil"""

# Contenu principal
contenu_index = """
<h2>Bienvenue sur notre site</h2>
<p>
  Ce site met en valeur les entreprises locales de la r√©gion de Gatineau.
  Vous y trouverez une carte interactive, une liste d√©taill√©e des entreprises participantes,
  ainsi que les produits et services qu‚Äôelles proposent (si cette information est disponible) .
</p>

<h2>Carte interactive</h2>
<iframe src="carte_pme_gatineau.html" width="100%" height="600" style="border:none; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.05);"></iframe>
"""

# üß¨ Ins√©rer la carte dans le template
html_index = bloc_entete("Accueil ‚Äì Entreprises locales") + contenu_index + bloc_footer

# üíæ Sauvegarder la page d‚Äôaccueil avec carte
with open("index.html", "w", encoding="utf-8") as f:
    f.write(html_index)

"""# Liste des entreprises"""

# G√©n√©rer la liste par secteur avec cartes visuelles
liste_html = ""

# Trier les secteurs
secteurs_ordonnes = sorted(df["Secteur"].dropna().unique())

for secteur in secteurs_ordonnes:
    liste_html += f"<section>\n<h2>{secteur}</h2>\n<div class='entreprises'>\n"

    # Filtrer les entreprises du secteur
    entreprises = df[df["Secteur"] == secteur]

    for _, row in entreprises.iterrows():
        nom = row["Nom de l'entreprise"]
        site = row["Site internet"] if pd.notnull(row["Site internet"]) else ""

        # üîë G√©n√©rer directement le chemin web relatif
        if 'Logo' in df.columns and pd.notnull(row['Logo']):
            logo = f"logo/{row['Logo']}"
        else:
            logo = "logo/default.png"

        # Carte visuelle avec description
        description = row["Description"] if "Description" in df.columns and pd.notnull(row["Description"]) else ""

        liste_html += f"""
        <div class="card">
          <img src="{logo}" alt="Logo de {nom}">
          <h4>{nom}</h4>
          <p>{description}</p>
          {"<a href='" + site + "' target='_blank'>Visiter le site</a>" if site else "<i>Site web non disponible</i>"}
        </div>
        """

    liste_html += "</div>\n</section>\n"

html_liste = bloc_entete("Liste des entreprises ‚Äì Entreprises locales") + liste_html + bloc_footer

# üíæ Sauvegarder la page
with open("liste.html", "w", encoding="utf-8") as f:
    f.write(html_liste)

"""# Produits

Regrouper les donn√©es par secteur et entreprise
"""

# Lire la feuille des produits (deuxi√®me feuille)
df_prod = pd.read_excel("Informations sur les entreprises.xlsx", sheet_name="Produits")

df_prod

# üîß Nettoyer les colonnes
df.columns = df.columns.str.strip().str.replace("\u00A0", " ").str.replace(r"\s+", " ", regex=True)
df_prod.columns = df_prod.columns.str.strip().str.replace("\u00A0", " ").str.replace(r"\s+", " ", regex=True)

# Initialiser le html
tables_html = ""

# Nombre de produits √† afficher en aper√ßu par entreprise
APERCU_N = 4

# üî† Trier les secteurs par ordre alphab√©tique
secteurs_ordonnes = sorted(df["Secteur"].dropna().unique())

for secteur in secteurs_ordonnes:
    tables_html += f"<section>\n<h2>Secteur : {secteur}</h2>\n"

    # üè¢ Filtrer les entreprises du secteur
    entreprises_du_secteur = df[df["Secteur"] == secteur].groupby("Nom de l'entreprise")

    for entreprise, groupe in entreprises_du_secteur:
        site = str(groupe["Site internet"].iloc[0]).strip() if "Site internet" in df.columns else ""

        tables_html += f"<div class='entreprise'>\n"
        tables_html += f"<h3>{entreprise}</h3>\n"

        # üîó Lien vers le site web si disponible
        if pd.notnull(site) and site.strip() != "":
            tables_html += f"<p><a href='{site}' target='_blank'>Visiter le site web</a></p>\n"
        else:
            tables_html += "<p><i>Site web non disponible</i></p>\n"

        # üì¶ Liste des produits
        produits_entreprise = df_prod[df_prod["Nom de l'entreprise"] == entreprise]

        if len(produits_entreprise) > 0:
            # Aper√ßu + reste
            apercu = produits_entreprise.head(APERCU_N)
            reste = produits_entreprise.iloc[APERCU_N:]

            # Grille des cartes
            tables_html += "<div class='produits-grid'>\n"

            # Fonction utilitaire locale pour g√©n√©rer une carte
            def carte_produit_html(prow):
              # Nettoyer les champs
              def safe_str(value):
                if pd.isna(value):
                  return ""
                v = str(value).strip()
                return "" if v.lower() in ["nan", "none", ""] else v

              produit = safe_str(prow.get("Produit", ""))
              prix = safe_str(prow.get("Prix", ""))
              description = safe_str(prow.get("Description", ""))
              image = safe_str(prow.get("Image", ""))

              # Dossier des images: 'produit/'
              img_src = f"produit/{image}" if image else "produit/default.png"

              # Carte HTML
              html = f"""
                <div class="product-card">
                 <div class="product-image"><img src="{img_src}" alt="{produit}"></div>
                 <div class="product-info">
                <div class="product-name">{produit}</div>
              """

              # Prix avec fallback
              if prix:
                html += f"<div class='product-price'>{prix}</div>"
              else:
                html += "<div class='product-price'><i>Aucun prix disponible</i></div>"

              # Description avec fallback
              if description:
                html += f"<div class='product-desc'>{description}</div>"
              else:
                html += "<div class='product-desc'><i>Aucune description disponible</i></div>"

              html += """
                </div>
              </div>
              """
              return html

            # Aper√ßu visible
            for _, prow in apercu.iterrows():
                tables_html += carte_produit_html(prow)

            tables_html += "</div>\n"  # fin .produits-grid


            # Bloc cach√© pour le reste
            if len(reste) > 0:
                bloc_id = f"products-{hash(entreprise) % (10**8)}"
                tables_html += f"<div id='{bloc_id}' class='produits-grid produits-cache' style='display:none;'>\n"
                for _, prow in reste.iterrows():
                    tables_html += carte_produit_html(prow)
                tables_html += "</div>\n"

                # Bouton Voir plus / Voir moins
                tables_html += f"""
                <div class="produits-actions">
                  <button class="btn-toggle" data-target="{bloc_id}">Voir plus</button>
                </div>
                """
        else:
            tables_html += "<p><i>Aucun produit ou service n'est repertori√© actuellement</i></p>\n"

        tables_html += "</div>\n"

    tables_html += "</section>\n"


# Int√©grer dans le mod√®le
html_produits = bloc_entete("Produits offerts ‚Äì Entreprises locales") + """
<h2>Produits et services propos√©s</h2>
<p>Voici les produits class√©s par secteur et entreprise.</p>
""" + tables_html + """
<script>
  // Toggle "Voir plus" / "Voir moins"
  document.addEventListener('click', function(e) {
    if (e.target && e.target.classList.contains('btn-toggle')) {
      const targetId = e.target.getAttribute('data-target');
      const bloc = document.getElementById(targetId);
      if (!bloc) return;
      const visible = bloc.style.display !== 'none';
      bloc.style.display = visible ? 'none' : 'grid';
      e.target.textContent = visible ? 'Voir plus' : 'Voir moins';
    }
  });
</script>
""" + bloc_footer

# üíæ Sauvegarder
with open("produits.html", "w", encoding="utf-8") as f:
    f.write(html_produits)

"""# Page de contacts"""

html_contact = bloc_entete("Nous contacter ‚Äì Entreprises locales") + """
<h2>Contactez notre √©quipe</h2>
<p>Ce projet est r√©alis√© par l‚Äô√©quipe <strong>D√©couvez Gatineau: Nos entreprises locales</strong>, dans le cadre d‚Äôun travail universitaire visant √† valoriser les entreprises locales.</p>
<p class="email">üìß Pour nous joindre : <a href="mailto:gaua83@uqo.ca">gaua83@uqo.ca</a></p>
<p class="facebook">
   üåê Retrouvez-nous sur Facebook :
   <a href="https://www.facebook.com/people/Nos-Entreprises-Locales/61584067825922"
      target="_blank"
      class="btn-facebook">
      <i class="fab fa-facebook-f"></i> Nos Entreprises Locales
   </a>
</p>


""" + bloc_footer

# üíæ Sauvegarder la page contact
with open("contact.html", "w", encoding="utf-8") as f:
    f.write(html_contact)
